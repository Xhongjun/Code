<!DOCTYPE html>
<html  lang="zh" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="keywords" content="">
	<meta name="description" content="">
    <!--360浏览器优先以webkit内核解析-->
    <title>首页</title>
    <link rel="shortcut icon" href="favicon.ico">
    <link href="../static/css/bootstrap.min.css" th:href="@{/css/bootstrap.min.css}" rel="stylesheet"/>
    <link href="../static/css/font-awesome.min.css" th:href="@{/css/font-awesome.min.css}" rel="stylesheet"/>
    <link href="../static/css/main/animate.min.css" th:href="@{/css/main/animate.min.css}" rel="stylesheet"/>
    <link href="../static/custom/custom.css" th:href="@{/custom/custom.css}" rel="stylesheet"/>
    <link href="../static/css/main/style.min862f.css" th:href="@{/css/main/style.min862f.css}" rel="stylesheet"/>
    
    <script th:src="@{/js/jquery.min.js}"></script>
	<link rel="shortcut icon" href="favicon.ico">
	<link th:href="@{/css/font-awesome.min.css}" rel="stylesheet"/>
	<!-- bootstrap-table 表格插件样式 -->
	<link th:href="@{/ajax/libs/bootstrap-table/bootstrap-table.min.css}" rel="stylesheet"/>
	<link th:href="@{/ajax/libs/bootstrap-treetable/bootstrap-treetable.css}" rel="stylesheet"/>
	<link th:href="@{/css/style.css}" rel="stylesheet"/>
	<link th:href="@{/ajax/libs/select/select2.css}" rel="stylesheet"/>
	<link th:href="@{/ruoyi/css/ry-ui.css}" rel="stylesheet"/>
</head>


<body class="gray-bg">
    <!-- <h1>待办任务</h1>
    <div class="row  border-bottom white-bg dashboard-header">
        <div class="col-sm-12 select-table table-striped">
		    <table id="custom-table" class="table-fixed" data-mobile-responsive="true"></table>
		</div>
    </div> -->
    <h1>待上线任务</h1>
    <div class="row  border-bottom white-bg dashboard-header">
		<div class="col-sm-12 search-collapse">
			<form id="post-form">
				<div class="select-list">
					<ul>
						<li>
							任务名称：<input type="text" name="onlineTask"/>
						</li>
						<li class="select-time select-time-two">
							<label>确定上线时间： </label>
							<input type="text" class="time-input" id="startTime" placeholder="开始时间" name="params[beginTime]"/>
							<span>-</span>
							<input type="text" class="time-input" id="endTime" placeholder="结束时间" name="params[endTime]"/>
						</li>
						<li>
							<a class="btn btn-primary btn-rounded btn-sm" onclick="$.table.search()"><i class="fa fa-search"></i>&nbsp;搜索</a>
						    <a class="btn btn-warning btn-rounded btn-sm" onclick="$.form.reset()"><i class="fa fa-refresh"></i>&nbsp;重置</a>
						</li>
					</ul>
				</div>
			</form>
		</div>
        
        <div class="col-sm-12 select-table table-striped">
		    <table id="bootstrap-table" class="table-fixed" data-mobile-responsive="true"></table>
		</div>
    </div>
    <!-- <div class="wrapper wrapper-content">
        <div class="row">
        </div>
    </div> -->
    <script th:src="@{/js/jquery.min.js}"></script>
    <script th:src="@{/js/bootstrap.min.js}"></script>
    <div th:include="include :: footer"></div>
    <script type="text/javascript">
    var prefix = ctx;
    $(function() {
	    /* var taskOptions = {
	        url: prefix + "goOnline/showTaskList",
	        detailUrl: prefix + "leave/getProcImage?processInstanceId={id}",
	        modalName: "待办任务",
	        search: false,
	        showSearch: false,
	        showColumns: false,
	        showExport: false,
	        columns: [
	        {
	            field: 'id',
	            title: '任务编码'
	        },
	        {
	            field: 'userName',
	            title: '申请人'
	        },
	        {
	            field: 'description',
	            title: '任务名称'
	        },
	        {
	            field: 'name',
	            title: '当前节点'
	        },
	        {
	            field: 'createTime',
	            title: '创建时间',
	            formatter: function (value, row, index) {
	                return changeDateFormat(value)
	            }
	        },
	        {
	            field: 'processInstanceId',
	            title: '流程实例ID'
	        },
	        {
	            field: 'remark',
	            title: '备注',
	            formatter: fieldFormatter
	        }]
	    };
	    $.customTable.init(taskOptions); */
	    var defaultDate = getDay(new Date());
	    $('#startTime').val(defaultDate);
		$('#endTime').val(defaultDate);
	    
	    var options = {
	        url: prefix + "goOnline/listNow",
	        updateUrl: prefix + "leave/getProcImage?processInstanceId={id}",
	        detailUrl: prefix + "goOnline/toView/{id}",
	        modalName: "任务",
	        search: false,
	        showExport: false,
	        showColumns: false,
	        columns: [
	        {
	            field: 'onlineTask',
	            title: '任务名称'
	        },
	        {
	            field: 'createTime',
	            title: '提测时间',
	            formatter: function (value, row, index) {
	                return changeDateFormat(value)
	            }
	        },
	        /* {
	        	field: 'testCompleteTime',
	            title: '测试完成时间',
	            formatter: function (value, row, index) {
	                return changeDayFormat(value)
	            }
	        }, */
	        {
	        	field: 'finalPlannedOnlineTime',
	            title: '确定上线时间',
	            formatter: function (value, row, index) {
	                return changeDayFormat(value)
	            }
	        },
	        {
	            field: 'devName',
	            title: '开发人员'
	        },
	        {
	            field: 'testName',
	            title: '测试人员'
	        },
	        {
	            field: 'currentTask',
	            title: '当前节点',
	            formatter: fieldFormatter
	        },
	        {
	            field: 'packageName',
	            title: '包名',
	            formatter: packageFormatter
	        },
	        {
	            field: 'operator',
	            title: '运维'
	        },
	        {
	            title: '操作',
	            align: 'center',
	            formatter: function(value, row, index) {
	                var actions = [];
	                actions.push('<a class="btn btn-warning btn-xs " href="#" onclick="$.operate.detail(\'' + row.id + '\')"><i class="fa fa-search"></i>查看详情</a> ');
	                return actions.join('');
	            }
	        }]
	    };
	    $.table.init(options);
	    $.table.search();
	});
    
  	//转换日期格式(时间戳转换为datetime格式)
    function changeDateFormat(cellval) {
        var dateVal = cellval + "";
        if (cellval != null) {
            var date = new Date(parseInt(dateVal.replace("/Date(", "").replace(")/", ""), 10));
            var month = date.getMonth() + 1 < 10 ? "0" + (date.getMonth() + 1) : date.getMonth() + 1;
            var currentDate = date.getDate() < 10 ? "0" + date.getDate() : date.getDate();
            
            var hours = date.getHours() < 10 ? "0" + date.getHours() : date.getHours();
            var minutes = date.getMinutes() < 10 ? "0" + date.getMinutes() : date.getMinutes();
            var seconds = date.getSeconds() < 10 ? "0" + date.getSeconds() : date.getSeconds();
            
            return date.getFullYear() + "-" + month + "-" + currentDate + " " + hours + ":" + minutes + ":" + seconds;
        }
    }
  	
  //转换日期格式(时间戳转换为datetime格式)
    function changeDayFormat(cellval) {
        var dateVal = cellval + "";
        if (cellval != null) {
            var date = new Date(parseInt(dateVal.replace("/Date(", "").replace(")/", ""), 10));
            var month = date.getMonth() + 1 < 10 ? "0" + (date.getMonth() + 1) : date.getMonth() + 1;
            var currentDate = date.getDate() < 10 ? "0" + date.getDate() : date.getDate();
            return date.getFullYear() + "-" + month + "-" + currentDate;
        }
    }
    </script>
</body>
</html>
